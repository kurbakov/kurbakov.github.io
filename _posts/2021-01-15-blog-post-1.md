---
title: 'Short story long: Hello world, C++'
date: 2021-01-15
permalink: /posts/2021/01/blog-post-1/
tags:
  - hello-world
  - cpp
---

Every person who writes code some day wrote a hello world programm. Usually it is copying the text in any editor, save, compile and run. In this post we will have a deeper look in compilation and execution stages and undertsnd what hellens, oncce you press enter for compilation and execution.

## Code

A simple hello world in c++ will look like this:


*main.cpp*

```cpp
#include <iostream>

int main()
{
    std::cout << "Hello world!\n";
    return 0;
}
```

And to build it, using `gcc` comiler, you would run something like:

```bash
g++ main.cpp -o main.out
```

Once you are done, you can execute the code by running:

```bash
./main.out
```

But what exactly does compiler to generate the exacutable?

Let's take a look!

## Compilation

Compilation consist of 4 steps, that compiler does for us. Lets check each of them!

### Step 0: Compiler initialization

I do not count it as the step. But just important to mantion, the GCC compiler has an initialization step. It parses the command line and understands that we want to compile the file `main.cpp` and the outut file we want to name `main.out`. We can pass also other arguments, but for simplisity we keep them default.[1][1]

During the initialization, the global scope of GCC is created as well as initialized the backend and build-in data types.

### Step 1: Preprocessing

[Preprocessor](https://en.cppreference.com/w/cpp/preprocessor) takes the souce code, in our case it is a `main.cpp` and executes preprocessor directives.

In `main.cpp` we have 1 preprocessor directive [include](https://en.cppreference.com/w/cpp/preprocessor/include). This directive means taking the file `iostream`, in my case the file is located in `/usr/include/c++/9/iostream`, and just insert the content of the `iostream` file into the `main.cpp` in the line immidiately after the directive.

The function runs recursivly untill all includes are covered.

In C++ we have many directives, that are available for developers. If you want to get more information, check [here](http://www.cplusplus.com/doc/tutorial/preprocessor/).

The outcome of the first in our case is one big text file, that has all code we need to run the programm.

The cool thing is that you can actually see the file. just run 

```bash
g++ -E main.cpp &> main.prep
gedit main.prep 
```

In my case, I have 28630 lines of code in the file. So as you can see, even very small code of the hello world cound create a giant files.

### Step 2: Compiler

The compiler takes the source code file and generates the assembly code.

#### Step 2.1 Frontend

#### Step 2.2 Middle-end

#### Step 2.3 Backend

### Step 3: Assembler

### Step 4: Linker


### Used sources

[1]: https://en.wikibooks.org/wiki/GNU_C_Compiler_Internals/GNU_C_Compiler_Architecture
